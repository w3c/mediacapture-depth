<!DOCTYPE html>
<html lang="en" dir="ltr" typeof="bibo:Document w3p:WD" prefix="bibo: http://purl.org/ontology/bibo/ w3p: http://www.w3.org/2001/02pd/rec54#">
<head><meta lang="" property="dc:language" content="en">
    <title>
      Media Capture Depth Stream Extensions
    </title>
    <meta charset="utf-8">
    
    
  <style>/*****************************************************************
 * ReSpec 3 CSS
 * Robin Berjon - http://berjon.com/
 *****************************************************************/

/* --- INLINES --- */
em.rfc2119 { 
    text-transform:     lowercase;
    font-variant:       small-caps;
    font-style:         normal;
    color:              #900;
}

h1 acronym, h2 acronym, h3 acronym, h4 acronym, h5 acronym, h6 acronym, a acronym,
h1 abbr, h2 abbr, h3 abbr, h4 abbr, h5 abbr, h6 abbr, a abbr {
    border: none;
}

dfn {
    font-weight:    bold;
}

a.internalDFN {
    color:  inherit;
    border-bottom:  1px solid #99c;
    text-decoration:    none;
}

a.externalDFN {
    color:  inherit;
    border-bottom:  1px dotted #ccc;
    text-decoration:    none;
}

a.bibref {
    text-decoration:    none;
}

cite .bibref {
    font-style: normal;
}

code {
    color:  #C83500;
}

/* --- TOC --- */
.toc a, .tof a {
    text-decoration:    none;
}

a .secno, a .figno {
    color:  #000;
}

ul.tof, ol.tof {
    list-style: none outside none;
}

.caption {
    margin-top: 0.5em;
    font-style:   italic;
}

/* --- TABLE --- */
table.simple {
    border-spacing: 0;
    border-collapse:    collapse;
    border-bottom:  3px solid #005a9c;
}

.simple th {
    background: #005a9c;
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
}

.simple th[scope="row"] {
    background: inherit;
    color:  inherit;
    border-top: 1px solid #ddd;
}

.simple td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
}

.simple tr:nth-child(even) {
    background: #f0f6ff;
}

/* --- DL --- */
.section dd > p:first-child {
    margin-top: 0;
}

.section dd > p:last-child {
    margin-bottom: 0;
}

.section dd {
    margin-bottom:  1em;
}

.section dl.attrs dd, .section dl.eldef dd {
    margin-bottom:  0;
}

@media print {
    .removeOnSave {
        display: none;
    }
}
</style><style>/* --- EXAMPLES --- */
div.example-title {
    min-width: 7.5em;
    color: #b9ab2d;
}
div.example-title span {
    text-transform: uppercase;   
}
aside.example, div.example, div.illegal-example {
    padding: 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
div.illegal-example { color: red }
div.illegal-example p { color: black }
aside.example, div.example {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
    border-color: #e0cb52;
    background: #fcfaee;    
}

aside.example div.example {
    border-left-width: .1em;
    border-color: #999;
    background: #fff;
}
aside.example div.example div.example-title {
    color: #999;
}
</style><style>/* --- ISSUES/NOTES --- */
div.issue-title, div.note-title , div.warning-title {
    padding-right:  1em;
    min-width: 7.5em;
    color: #b9ab2d;
}
div.issue-title { color: #e05252; }
div.note-title { color: #2b2; }
div.warning-title { color: #f22; }
div.issue-title span, div.note-title span, div.warning-title span {
    text-transform: uppercase;
}
div.note, div.issue, div.warning {
    margin-top: 1em;
    margin-bottom: 1em;
}
.note > p:first-child, .issue > p:first-child, .warning > p:first-child { margin-top: 0 }
.issue, .note, .warning {
    padding: .5em;
    border-left-width: .5em;
    border-left-style: solid;
}
div.issue, div.note , div.warning {
    padding: 1em 1.2em 0.5em;
    margin: 1em 0;
    position: relative;
    clear: both;
}
span.note, span.issue, span.warning { padding: .1em .5em .15em; }

.issue {
    border-color: #e05252;
    background: #fbe9e9;
}
.note {
    border-color: #52e052;
    background: #e9fbe9;
}

.warning {
    border-color: #f11;
    border-right-width: .2em;
    border-top-width: .2em;
    border-bottom-width: .2em;
    border-style: solid;
    background: #fbe9e9;
}

.warning-title:before{
    content: "⚠"; /*U+26A0 WARNING SIGN*/
    font-size: 3em;
    float: left;
    height: 100%;
    padding-right: .3em;
    vertical-align: top;
    margin-top: -0.5em;
}
</style><style>/* HIGHLIGHTS */
code.prettyprint {
    color:  inherit;
}

/* this from google-code-prettify */
.pln{color:#000}@media screen{.str{color:#080}.kwd{color:#008}.com{color:#800}.typ{color:#606}.lit{color:#066}.pun,.opn,.clo{color:#660}.tag{color:#008}.atn{color:#606}.atv{color:#080}.dec,.var{color:#606}.fun{color:red}}@media print,projection{.str{color:#060}.kwd{color:#006;font-weight:bold}.com{color:#600;font-style:italic}.typ{color:#404;font-weight:bold}.lit{color:#044}.pun,.opn,.clo{color:#440}.tag{color:#006;font-weight:bold}.atn{color:#404}.atv{color:#060}}ol.linenums{margin-top:0;margin-bottom:0}li.L0,li.L1,li.L2,li.L3,li.L5,li.L6,li.L7,li.L8{list-style-type:none}li.L1,li.L3,li.L5,li.L7,li.L9{background:#eee}
</style><style>/* --- WEB IDL --- */
pre.idl {
    border-top: 1px solid #90b8de;
    border-bottom: 1px solid #90b8de;
    padding:    1em;
    line-height:    120%;
}

pre.idl::before {
    content:    "WebIDL";
    display:    block;
    width:      150px;
    background: #90b8de;
    color:  #fff;
    font-family:    initial;
    padding:    3px;
    font-weight:    bold;
    margin: -1em 0 1em -1em;
}

.idlType {
    color:  #ff4500;
    font-weight:    bold;
    text-decoration:    none;
}

/*.idlModule*/
/*.idlModuleID*/
/*.idlInterface*/
.idlInterfaceID, .idlDictionaryID, .idlCallbackID, .idlEnumID {
    font-weight:    bold;
    color:  #005a9c;
}
a.idlEnumItem {
    color:  #000;
    border-bottom:  1px dotted #ccc;
    text-decoration: none;
}

.idlSuperclass {
    font-style: italic;
    color:  #005a9c;
}

/*.idlAttribute*/
.idlAttrType, .idlFieldType, .idlMemberType {
    color:  #005a9c;
}
.idlAttrName, .idlFieldName, .idlMemberName {
    color:  #ff4500;
}
.idlAttrName a, .idlFieldName a, .idlMemberName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlMethod*/
.idlMethType, .idlCallbackType {
    color:  #005a9c;
}
.idlMethName {
    color:  #ff4500;
}
.idlMethName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlCtor*/
.idlCtorName {
    color:  #ff4500;
}
.idlCtorName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlParam*/
.idlParamType {
    color:  #005a9c;
}
.idlParamName, .idlDefaultValue {
    font-style: italic;
}

.extAttr {
    color:  #666;
}

/*.idlSectionComment*/
.idlSectionComment {
    color: gray;
}

/*.idlConst*/
.idlConstType {
    color:  #005a9c;
}
.idlConstName {
    color:  #ff4500;
}
.idlConstName a {
    color:  #ff4500;
    border-bottom:  1px dotted #ff4500;
    text-decoration: none;
}

/*.idlException*/
.idlExceptionID {
    font-weight:    bold;
    color:  #c00;
}

.idlTypedefID, .idlTypedefType {
    color:  #005a9c;
}

.idlRaises, .idlRaises a.idlType, .idlRaises a.idlType code, .excName a, .excName a code {
    color:  #c00;
    font-weight:    normal;
}

.excName a {
    font-family:    monospace;
}

.idlRaises a.idlType, .excName a.idlType {
    border-bottom:  1px dotted #c00;
}

.excGetSetTrue, .excGetSetFalse, .prmNullTrue, .prmNullFalse, .prmOptTrue, .prmOptFalse {
    width:  45px;
    text-align: center;
}
.excGetSetTrue, .prmNullTrue, .prmOptTrue { color:  #0c0; }
.excGetSetFalse, .prmNullFalse, .prmOptFalse { color:  #c00; }

.idlImplements a {
    font-weight:    bold;
}

dl.attributes, dl.methods, dl.constants, dl.constructors, dl.fields, dl.dictionary-members {
    margin-left:    2em;
}

.attributes dt, .methods dt, .constants dt, .constructors dt, .fields dt, .dictionary-members dt {
    font-weight:    normal;
}

.attributes dt code, .methods dt code, .constants dt code, .constructors dt code, .fields dt code, .dictionary-members dt code {
    font-weight:    bold;
    color:  #000;
    font-family:    monospace;
}

.attributes dt code, .fields dt code, .dictionary-members dt code {
    background:  #ffffd2;
}

.attributes dt .idlAttrType code, .fields dt .idlFieldType code, .dictionary-members dt .idlMemberType code {
    color:  #005a9c;
    background:  transparent;
    font-family:    inherit;
    font-weight:    normal;
    font-style: italic;
}

.methods dt code {
    background:  #d9e6f8;
}

.constants dt code {
    background:  #ddffd2;
}

.constructors dt code {
    background:  #cfc;
}

.attributes dd, .methods dd, .constants dd, .constructors dd, .fields dd, .dictionary-members dd {
    margin-bottom:  1em;
}

table.parameters, table.exceptions {
    border-spacing: 0;
    border-collapse:    collapse;
    margin: 0.5em 0;
    width:  100%;
}
table.parameters { border-bottom:  1px solid #90b8de; }
table.exceptions { border-bottom:  1px solid #deb890; }

.parameters th, .exceptions th {
    color:  #fff;
    padding:    3px 5px;
    text-align: left;
    font-family:    initial;
    font-weight:    normal;
    text-shadow:    #666 1px 1px 0;
}
.parameters th { background: #90b8de; }
.exceptions th { background: #deb890; }

.parameters td, .exceptions td {
    padding:    3px 10px;
    border-top: 1px solid #ddd;
    vertical-align: top;
}

.parameters tr:first-child td, .exceptions tr:first-child td {
    border-top: none;
}

.parameters td.prmName, .exceptions td.excName, .exceptions td.excCodeName {
    width:  100px;
}

.parameters td.prmType {
    width:  120px;
}

table.exceptions table {
    border-spacing: 0;
    border-collapse:    collapse;
    width:  100%;
}
</style><link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/W3C-WD"><!--[if lt IE 9]><script src='https://www.w3.org/2008/site/js/html5shiv.js'></script><![endif]--></head>
  <body style="" class="h-entry" role="document" id="respecDocument"><div class="head" role="contentinfo" id="respecHeader">
  <p>
      
        
            <a href="http://www.w3.org/"><img width="72" height="48" src="https://www.w3.org/Icons/w3c_home" alt="W3C"></a>
        
      
  </p>
  <h1 class="title p-name" id="title" property="dcterms:title">Media Capture Depth Stream Extensions</h1>
  
  <h2 id="w3c-working-draft-29-january-2015"><abbr title="World Wide Web Consortium">W3C</abbr> Working Draft <time property="dcterms:issued" class="dt-published" datetime="2015-01-29">29 January 2015</time></h2>
  <dl>
    
      <dt>This version:</dt>
      <dd><a class="u-url" href="http://www.w3.org/TR/2015/WD-mediacapture-depth-20150129/">http://www.w3.org/TR/2015/WD-mediacapture-depth-20150129/</a></dd>
      <dt>Latest published version:</dt>
      <dd><a href="http://www.w3.org/TR/mediacapture-depth/">http://www.w3.org/TR/mediacapture-depth/</a></dd>
    
    
      <dt>Latest editor's draft:</dt>
      <dd><a href="http://w3c.github.io/mediacapture-depth/">http://w3c.github.io/mediacapture-depth/</a></dd>
    
    
    
    
    
    
      <dt>Previous version:</dt>
      <dd><a rel="dcterms:replaces" href="http://www.w3.org/TR/2014/WD-mediacapture-depth-20141007/">http://www.w3.org/TR/2014/WD-mediacapture-depth-20141007/</a></dd>
    
    
    <dt>Editors:</dt>
    <dd class="p-author h-card vcard" property="bibo:editor" resource="_:editor0"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Anssi Kostiainen</span>, <a property="foaf:workplaceHomepage" class="p-org org h-org h-card" href="http://www.intel.com/">Intel</a></span>
<span property="rdf:rest" resource="_:editor1"></span>
</dd>
<dd class="p-author h-card vcard" resource="_:editor1"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Ningxin Hu</span>, <a property="foaf:workplaceHomepage" class="p-org org h-org h-card" href="http://www.intel.com/">Intel</a></span>
<span property="rdf:rest" resource="_:editor2"></span>
</dd>
<dd class="p-author h-card vcard" resource="_:editor2"><span property="rdf:first" typeof="foaf:Person"><span property="foaf:name" class="p-name fn">Rob Manson</span>, Invited Expert</span>
<span property="rdf:rest" resource="rdf:nil"></span>
</dd>

    
    
      
        
          <dt>Participate:</dt>
          
             
                
                  <dd>
                    <a href="http://lists.w3.org/Archives/Public/public-media-capture/">
                      Mailing list
                    </a>
                  </dd>
                
             
                
                  <dd>
                    <a href="https://github.com/w3c/mediacapture-depth/">
                      GitHub repository
                    </a>
                  </dd>
                
             
                
                  <dd>
                    <a href="https://github.com/w3c/mediacapture-depth/issues">
                      Open issues
                    </a>
                  </dd>
                
             
                
                  <dd>
                    <a href="https://github.com/w3c/mediacapture-depth/commits/">
                      Commit history
                    </a>
                  </dd>
                
             
          
        
      
    
  </dl>
  
  
  
  
    
      <p class="copyright">
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> ©
        2015
        
        <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup>
        (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>,
        <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>,
        <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>), 
        
        All Rights Reserved.
        
        <abbr title="World Wide Web Consortium">W3C</abbr> <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>,
        <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and
        
          <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a>
        
        rules apply.
      </p>
    
  
  <hr>
</div>
    <section id="abstract" class="introductory" property="dc:abstract"><h2 id="h-abstract" resource="#h-abstract"><span property="xhv:role" resource="xhv:heading">Abstract</span></h2>
      <p>
        This specification extends the <em>Media Capture and Streams</em>
        specification [<cite><a class="bibref" href="#bib-GETUSERMEDIA">GETUSERMEDIA</a></cite>] to allow a <a href="#dfn-depth-stream" class="internalDFN">depth stream</a> to be
        requested from the web platform using APIs familiar to web authors.
      </p>
    </section><section id="sotd" class="introductory"><h2 id="h-sotd" resource="#h-sotd"><span property="xhv:role" resource="xhv:heading">Status of This Document</span></h2>
  
    
      
        <p>
          <em>This section describes the status of this document at the time of its publication.
          Other documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the
          latest revision of this technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
          http://www.w3.org/TR/.</em>
        </p>
        
        
      <p>
        The following changes were made since the <a href="http://www.w3.org/TR/2014/WD-mediacapture-depth-20141007/"><abbr title="World Wide Web Consortium">W3C</abbr> First
        Public Working Draft 07 October 2014</a>:
      </p>
      <ul>
        <li>Removed the <a href="http://www.w3.org/TR/2014/WD-mediacapture-depth-20141007/#depthdata-interface">
          <code>DepthData</code></a> interface
        </li>
        <li>Added depth value presentation into the <a href="#imagedata-interface"><code>ImageData</code></a> interface
        </li>
        <li>Added a <a href="#dfn-depth-video-element" class="internalDFN">depth video element</a> as an image source in the
        <a href="#canvasimagesource-typedef"><code>CanvasImageSource</code>
        typedef</a>
        </li>
        <li>Added support for <a href="#direct-assignment-to-media-elements">direct assignment to media
        elements</a> for <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code> object containing a
        <a href="#dfn-depth-track" class="internalDFN">depth track</a>
        </li>
        <li>Added new properties to the <a href="#idl-def-Settings" class="idlType"><code>Settings</code></a> dictionary
        </li>
        <li>Added new definitions to the <a href="#terminology">terminology</a>
        section
        </li>
        <li>Added a non-normative <a href="#implementation-considerations">implementation considerations</a>
        section regarding combining a <a href="#dfn-depth-track" class="internalDFN">depth track</a> and a <a href="#dfn-video-track" class="internalDFN">video
        track</a> into one <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code> object
        </li>
        <li>Added a non-normative <a href="#implementation-considerations-1">implementation considerations</a>
        section considering the <a href="#webglrenderingcontext-interface"><code>WebGLRenderingContext</code></a>
        interface
        </li>
        <li>Added <a href="#examples">examples</a> for 2D canvas context and
        WebGL fragment shader based post-processing
        </li>
      </ul>
      <p>
        <strong>This document is not complete and is subject to change. Early
        experimentations are encouraged to allow the Media Capture Task Force
        to evolve the specification based on technical discussions within the
        Task Force, implementation experience gained from early
        implementations, and feedback from other groups and
        individuals.</strong>
      </p>
    
        
        <p>
          This document was published by the <a href="http://www.w3.org/2009/dap/">Device APIs Working Group</a> and <a href="http://www.w3.org/2011/04/webrtc/">Web Real-Time Communications Working Group</a> as a Working Draft.
          
            This document is intended to become a <abbr title="World Wide Web Consortium">W3C</abbr> Recommendation.
          
          
            If you wish to make comments regarding this document, please send them to 
            <a href="mailto:public-media-capture@w3.org">public-media-capture@w3.org</a> 
            (<a href="mailto:public-media-capture-request@w3.org?subject=subscribe">subscribe</a>,
            <a href="http://lists.w3.org/Archives/Public/public-media-capture/">archives</a>).
          
          
          
          
          
            
            All comments are welcome.
            
          
        </p>
        
        
        
          <p>
            Publication as a Working Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr>
            Membership. This is a draft document and may be updated, replaced or obsoleted by other
            documents at any time. It is inappropriate to cite this document as other than work in
            progress.
          </p>
        
        
        
        <p>
          
            This document was produced by a group operating under the 
            <a id="sotd_patent" property="w3p:patentRules" href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent
            Policy</a>.
          
          
          
            
              <abbr title="World Wide Web Consortium">W3C</abbr> maintains a public list of any patent disclosures (<a href="http://www.w3.org/2004/01/pp-impl/47318/status" rel="disclosure">Device APIs Working Group</a>, <a href="http://www.w3.org/2004/01/pp-impl/43696/status" rel="disclosure">Web Real-Time Communications Working Group</a>)
            
            made in connection with the deliverables of the group; that page also includes
            instructions for disclosing a patent. An individual who has actual knowledge of a patent
            which the individual believes contains
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
            Claim(s)</a> must disclose the information in accordance with
            <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
            6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
          
          
        </p>
        
          <p>This document is governed by the <a id="w3c_process_revision" href="http://www.w3.org/2014/Process-20140801/">1 August 2014 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
          </p>
        
        
      
    
  
</section><section id="toc"><h2 class="introductory" id="h-toc" resource="#h-toc"><span property="xhv:role" resource="xhv:heading">Table of Contents</span></h2><ul class="toc" role="directory" id="respecContents"><li class="tocline"><a href="#introduction" class="tocxref"><span class="secno">1. </span>
        Introduction
      </a></li><li class="tocline"><a href="#use-cases-and-requirements" class="tocxref"><span class="secno">2. </span>
        Use cases and requirements
      </a></li><li class="tocline"><a href="#conformance" class="tocxref"><span class="secno">3. </span>Conformance</a></li><li class="tocline"><a href="#terminology" class="tocxref"><span class="secno">4. </span>
        Terminology
      </a></li><li class="tocline"><a href="#extensions" class="tocxref"><span class="secno">5. </span>
        Extensions
      </a><ul class="toc"><li class="tocline"><a href="#mediastreamconstraints-dictionary" class="tocxref"><span class="secno">5.1 </span>
          <code><span class="formerLink"><code>MediaStreamConstraints</code></span></code> dictionary
        </a></li><li class="tocline"><a href="#mediastream-interface" class="tocxref"><span class="secno">5.2 </span>
          <code>MediaStream</code> interface
        </a><ul class="toc"><li class="tocline"><a href="#implementation-considerations" class="tocxref"><span class="secno">5.2.1 </span>
            Implementation considerations
          </a></li></ul></li><li class="tocline"><a href="#mediastreamtrack-interface" class="tocxref"><span class="secno">5.3 </span>
          <code>MediaStreamTrack</code> interface
        </a></li><li class="tocline"><a href="#direct-assignment-to-media-elements" class="tocxref"><span class="secno">5.4 </span>
          Direct assignment to media elements
        </a></li><li class="tocline"><a href="#canvasimagesource-typedef" class="tocxref"><span class="secno">5.5 </span>
          <code>CanvasImageSource</code> typedef
        </a></li><li class="tocline"><a href="#imagedata-interface" class="tocxref"><span class="secno">5.6 </span>
          <code>ImageData</code> interface
        </a></li><li class="tocline"><a href="#settings-dictionary" class="tocxref"><span class="secno">5.7 </span>
          <code>Settings</code> dictionary
        </a></li><li class="tocline"><a href="#webglrenderingcontext-interface" class="tocxref"><span class="secno">5.8 </span>
          <code>WebGLRenderingContext</code> interface
        </a><ul class="toc"><li class="tocline"><a href="#implementation-considerations-1" class="tocxref"><span class="secno">5.8.1 </span>
            Implementation considerations
          </a></li></ul></li></ul></li><li class="tocline"><a href="#examples" class="tocxref"><span class="secno">6. </span>
        Examples
      </a></li><li class="tocline"><a href="#acknowledgements" class="tocxref"><span class="secno">A. </span>
        Acknowledgements
      </a></li><li class="tocline"><a href="#references" class="tocxref"><span class="secno">B. </span>References</a><ul class="toc"><li class="tocline"><a href="#normative-references" class="tocxref"><span class="secno">B.1 </span>Normative references</a></li><li class="tocline"><a href="#informative-references" class="tocxref"><span class="secno">B.2 </span>Informative references</a></li></ul></li></ul></section>
    
    <section id="introduction" typeof="bibo:Chapter" resource="#introduction" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-introduction" resource="#h-introduction"><span property="xhv:role" resource="xhv:heading"><span class="secno">1. </span>
        Introduction
      </span></h2>
      <p>
        Depth cameras are increasingly being integrated into devices such as
        phones, tablets, and laptops. Depth cameras provide a depth map, which
        conveys the distance information between points on an object's surface
        and the camera. With depth information, web content and applications
        can be enhanced by, for example, the use of hand gestures as an input
        mechanism, or by creating 3D models of real-world objects that can
        interact and integrate with the web platform. Concrete applications of
        this technology include more immersive gaming experiences, more
        accessible 3D video conferences, and augmented reality, to name a few.
      </p>
      <p>
        To bring depth capability to the web platform, this specification
        extends the <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code> interface [<cite><a class="bibref" href="#bib-GETUSERMEDIA">GETUSERMEDIA</a></cite>]
        to enable it to also contain depth-based
        <a href="#dfn-mediastreamtrack" class="internalDFN"><code>MediaStreamTrack</code></a>s. A depth-based
        <a href="#dfn-mediastreamtrack" class="internalDFN"><code>MediaStreamTrack</code></a>, referred to as a <a href="#dfn-depth-track" class="internalDFN">depth
        track</a>, represents an abstraction of a stream of frames that can
        each be converted to objects which contain an array of pixel data,
        where each pixel represents the distance between the camera and the
        objects in the scene for that point in the array. A
        <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code> object that contains one or more
        <a href="#dfn-depth-track" class="internalDFN">depth track</a>s is referred to as a <a href="#dfn-depth-stream" class="internalDFN">depth stream</a>.
      </p>
    </section>
    <section id="use-cases-and-requirements" typeof="bibo:Chapter" resource="#use-cases-and-requirements" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-use-cases-and-requirements" resource="#h-use-cases-and-requirements"><span property="xhv:role" resource="xhv:heading"><span class="secno">2. </span>
        Use cases and requirements
      </span></h2>
      <p>
        This specification attempts to address the <a href="https://www.w3.org/wiki/Media_Capture_Depth_Stream_Extension">Use
        Cases and Requirements</a> for accessing depth stream from a depth
        camera. See also the <a href="https://www.w3.org/wiki/Media_Capture_Depth_Stream_Extension#Examples">
        Examples</a> section for concrete usage examples.
      </p>
    </section>
    <section id="conformance" typeof="bibo:Chapter" resource="#conformance" property="bibo:hasPart"><!--OddPage--><h2 id="h-conformance" resource="#h-conformance"><span property="xhv:role" resource="xhv:heading"><span class="secno">3. </span>Conformance</span></h2>
<p>
  As well as sections marked as non-normative, all authoring guidelines, diagrams, examples,
  and notes in this specification are non-normative. Everything else in this specification is
  normative.
</p>
<p id="respecRFC2119">The key words <em class="rfc2119" title="MAY">MAY</em> and <em class="rfc2119" title="MUST">MUST</em> are 
  to be interpreted as described in [<cite><a class="bibref" href="#bib-RFC2119">RFC2119</a></cite>].
</p>

      <p>
        This specification defines conformance criteria that apply to a single
        product: the <dfn id="dfn-user-agent">user agent</dfn> that implements the interfaces that
        it contains.
      </p>
      <p>
        Implementations that use ECMAScript to implement the APIs defined in
        this specification must implement them in a manner consistent with the
        ECMAScript Bindings defined in the Web IDL specification [<cite><a class="bibref" href="#bib-WEBIDL">WEBIDL</a></cite>],
        as this specification uses that specification and terminology.
      </p>
    </section>
    <section id="terminology" typeof="bibo:Chapter" resource="#terminology" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-terminology" resource="#h-terminology"><span property="xhv:role" resource="xhv:heading"><span class="secno">4. </span>
        Terminology
      </span></h2>
      <p>
        The <code><a href="http://w3c.github.io/mediacapture-main/archives/20141205/getusermedia.html#idl-def-MediaStreamTrack">
        <dfn id="dfn-mediastreamtrack">MediaStreamTrack</dfn></a></code> and <code><a href="http://w3c.github.io/mediacapture-main/archives/20141205/getusermedia.html#idl-def-MediaStream">
        <dfn id="dfn-mediastream">MediaStream</dfn></a></code> interfaces this specification extends
        are defined in [<cite><a class="bibref" href="#bib-GETUSERMEDIA">GETUSERMEDIA</a></cite>].
      </p>
      <p>
        The <code><a href="http://w3c.github.io/mediacapture-main/archives/20141205/getusermedia.html#idl-def-Constraints">
        <dfn id="dfn-constraints">Constraints</dfn></a></code>, <code><a href="http://w3c.github.io/mediacapture-main/archives/20141205/getusermedia.html#dfn-settings">
        <dfn id="dfn-settings">Settings</dfn></a></code>, <code><a href="http://w3c.github.io/mediacapture-main/archives/20141205/getusermedia.html#idl-def-MediaStreamConstraints">
        <dfn id="dfn-mediastreamconstraints">MediaStreamConstraints</dfn></a></code>, and <code><a href="http://w3c.github.io/mediacapture-main/archives/20141205/getusermedia.html#idl-def-MediaTrackConstraints">
        <dfn id="dfn-mediatrackconstraints">MediaTrackConstraints</dfn></a></code> dictionaries this
        specification extends are based upon the <a href="http://w3c.github.io/mediacapture-main/archives/20141205/getusermedia.html#constrainable-interface">
        <dfn id="dfn-constrainable-pattern">Constrainable pattern</dfn></a> defined in [<cite><a class="bibref" href="#bib-GETUSERMEDIA">GETUSERMEDIA</a></cite>].
      </p>
      <p>
        The <code><a href="http://w3c.github.io/mediacapture-main/#idl-def-NavigatorUserMediaSuccessCallback">
        <dfn id="dfn-navigatorusermediasuccesscallback">NavigatorUserMediaSuccessCallback</dfn></a></code> callback is
        defined in [<cite><a class="bibref" href="#bib-GETUSERMEDIA">GETUSERMEDIA</a></cite>].
      </p>
      <p>
        The <code><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#canvasrenderingcontext2d">
        <dfn id="dfn-canvasrenderingcontext2d">CanvasRenderingContext2D</dfn></a></code> and <code><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#imagedata"><dfn id="dfn-imagedata">ImageData</dfn></a></code>
        interfaces, and the <code><a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#canvasimagesource"><dfn id="dfn-canvasimagesource">
        CanvasImageSource</dfn></a></code> typedef are defined in
        [<cite><a class="bibref" href="#bib-2DCONTEXT2">2DCONTEXT2</a></cite>].
      </p>
      <p>
        The <code><a href="https://www.khronos.org/registry/typedarray/specs/latest/#5"><dfn id="dfn-arraybuffer">ArrayBuffer</dfn></a></code>,
        <code><a href="http://www.khronos.org/registry/typedarray/specs/latest/#6"><dfn id="dfn-arraybufferview">ArrayBufferView</dfn></a></code>
        and <code><a href="http://www.khronos.org/registry/typedarray/specs/latest/#7"><dfn id="dfn-uint16array">Uint16Array</dfn></a></code>
        types are defined in [<cite><a class="bibref" href="#bib-TYPEDARRAY">TYPEDARRAY</a></cite>].
      </p>
      <p>
        A <dfn id="dfn-depth-stream">depth stream</dfn> is a <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code> object
        that contains one or more <a href="#dfn-depth-track" class="internalDFN">depth track</a>s.
      </p>
      <p>
        A <dfn id="dfn-depth-track">depth track</dfn> represents media sourced from a depth camera
        or other similar source.
      </p>
      <p>
        A <dfn id="dfn-video-track">video track</dfn> represents media sourced from an RGB camera or
        other similar source.
      </p>
    </section>
    <section id="extensions" typeof="bibo:Chapter" resource="#extensions" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-extensions" resource="#h-extensions"><span property="xhv:role" resource="xhv:heading"><span class="secno">5. </span>
        Extensions
      </span></h2>
      <section id="mediastreamconstraints-dictionary" typeof="bibo:Chapter" resource="#mediastreamconstraints-dictionary" property="bibo:hasPart">
        <h3 id="h-mediastreamconstraints-dictionary" resource="#h-mediastreamconstraints-dictionary"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.1 </span>
          <code><a href="#idl-def-MediaStreamConstraints" class="idlType"><code>MediaStreamConstraints</code></a></code> dictionary
        </span></h3>
        <pre class="idl"><span class="idlDictionary" id="idl-def-MediaStreamConstraints">partial dictionary <span class="idlDictionaryID">MediaStreamConstraints</span> {
<span class="idlMember">    <span class="idlMemberType">(boolean or <a href="#dfn-mediatrackconstraints" class="internalDFN">MediaTrackConstraints</a>)</span> <span class="idlMemberName"><a href="#widl-MediaStreamConstraints-depth">depth</a></span> = <span class="idlMemberValue">false</span>;</span>
};</span></pre>
        <p>
          The <code id="widl-MediaStreamConstraints-depth">depth</code>
          attribute <em class="rfc2119" title="MUST">MUST</em> return the value it was initialized to. When the
          object is created, this attribute <em class="rfc2119" title="MUST">MUST</em> be initialized to false. If
          true, the attribute represents a request that the
          <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code> object returned as an argument of the
          <code><a href="#dfn-navigatorusermediasuccesscallback" class="internalDFN">NavigatorUserMediaSuccessCallback</a></code> contains a
          <a href="#dfn-depth-track" class="internalDFN">depth track</a>. If a <a href="#dfn-constraints" class="internalDFN"><code>Constraints</code></a> structure is
          provided, it further specifies the nature and settings of the
          <a href="#dfn-depth-track" class="internalDFN">depth track</a>.
        </p>
      </section>
      <section id="mediastream-interface" typeof="bibo:Chapter" resource="#mediastream-interface" property="bibo:hasPart">
        <h3 id="h-mediastream-interface" resource="#h-mediastream-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2 </span>
          <code>MediaStream</code> interface
        </span></h3>
        <pre class="idl"><span class="idlInterface" id="idl-def-MediaStream">partial interface <span class="idlInterfaceID">MediaStream</span> {
<span class="idlMethod">    <span class="idlMethType">sequence&lt;<a href="#dfn-mediastreamtrack" class="internalDFN">MediaStreamTrack</a>&gt;</span> <span class="idlMethName"><a href="#widl-MediaStream-getDepthTracks-sequence-MediaStreamTrack">getDepthTracks</a></span> ();</span>
};</span></pre>
        <p>
          The <code id="widl-MediaStream-getDepthTracks-sequence-MediaStreamTrack"><dfn id="dfn-getdepthtracks">getDepthTracks()</dfn></code>
          method, when invoked, <em class="rfc2119" title="MUST">MUST</em> return a sequence of
          <a href="#dfn-mediastreamtrack" class="internalDFN"><code>MediaStreamTrack</code></a> objects representing the
          <a href="#dfn-depth-track" class="internalDFN">depth track</a>s in this stream.
        </p>
        <p>
          The <code><a href="#dfn-getdepthtracks" class="internalDFN">getDepthTracks()</a></code> method <em class="rfc2119" title="MUST">MUST</em> return a
          sequence that represents a snapshot of all the
          <a href="#dfn-mediastreamtrack" class="internalDFN"><code>MediaStreamTrack</code></a> objects in this stream's track
          set whose <code><a href="#dfn-kind" class="internalDFN">kind</a></code> is equal to "<code>depth</code>".
          The conversion from the track set to the sequence is <a href="#dfn-user-agent" class="internalDFN">user
          agent</a> defined and the order does not have to be stable between
          calls.
        </p>
        <section class="informative" id="implementation-considerations" typeof="bibo:Chapter" resource="#implementation-considerations" property="bibo:hasPart">
          <h4 id="h-implementation-considerations" resource="#h-implementation-considerations"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.2.1 </span>
            Implementation considerations
          </span></h4><p><em>This section is non-normative.</em></p>
          <p>
            A <a href="#dfn-mediastreamtrack" class="internalDFN"><code>MediaStreamTrack</code></a> object representing a
            <a href="#dfn-video-track" class="internalDFN">video track</a> and a <a href="#dfn-mediastreamtrack" class="internalDFN"><code>MediaStreamTrack</code></a>
            object representing a <a href="#dfn-depth-track" class="internalDFN">depth track</a> can be combined into one
            <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code> object. The rendering of the two
            tracks are intended to be synchronized. The resolution of the two
            tracks are intended to be same. And the coordination of the two
            tracks are intended to be calibrated. These are not hard
            requirements, since it might not be possible to synchronize tracks
            from sources.
          </p>
        </section>
      </section>
      <section id="mediastreamtrack-interface" typeof="bibo:Chapter" resource="#mediastreamtrack-interface" property="bibo:hasPart">
        <h3 id="h-mediastreamtrack-interface" resource="#h-mediastreamtrack-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.3 </span>
          <code>MediaStreamTrack</code> interface
        </span></h3>
        <p>
          The <code><dfn id="dfn-kind">kind</dfn></code> attribute <em class="rfc2119" title="MUST">MUST</em>, on getting, return
          the string "<code>depth</code>" if the object represents a <a href="#dfn-depth-track" class="internalDFN">depth
          track</a>.
        </p>
      </section>
      <section id="direct-assignment-to-media-elements" typeof="bibo:Chapter" resource="#direct-assignment-to-media-elements" property="bibo:hasPart">
        <h3 id="h-direct-assignment-to-media-elements" resource="#h-direct-assignment-to-media-elements"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.4 </span>
          Direct assignment to media elements
        </span></h3>
        <p>
          <a href="#dfn-user-agent" class="internalDFN">User agent</a>s that support <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code>
          <a href="http://w3c.github.io/mediacapture-main/archives/20141205/getusermedia.html#direct-assignment-to-media-elements">
          direct assignment to media elements</a> <em class="rfc2119" title="MUST">MUST</em> allow a
          <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code> object containing a <a href="#dfn-depth-track" class="internalDFN">depth
          track</a> to be assigned directly to a media element.
        </p>
        <p>
          For each <a href="#dfn-mediastreamtrack" class="internalDFN"><code>MediaStreamTrack</code></a> representing a <a href="#dfn-depth-track" class="internalDFN">depth
          track</a> in the <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code>, the <a href="#dfn-user-agent" class="internalDFN">user
          agent</a> <em class="rfc2119" title="MUST">MUST</em> create a corresponding <code><a href="http://www.w3.org/TR/html5/embedded-content-0.html#videotrack">VideoTrack</a></code>
          as defined in [<cite><a class="bibref" href="#bib-HTML5">HTML5</a></cite>].
        </p>
      </section>
      <section id="canvasimagesource-typedef" typeof="bibo:Chapter" resource="#canvasimagesource-typedef" property="bibo:hasPart">
        <h3 id="h-canvasimagesource-typedef" resource="#h-canvasimagesource-typedef"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.5 </span>
          <code>CanvasImageSource</code> typedef
        </span></h3>
        <div class="note"><div class="note-title" aria-level="4" role="heading" id="h-note1"><span>Note</span></div><div class="">
          <p>
            Several methods in the <a href="#dfn-canvasrenderingcontext2d" class="internalDFN"><code>CanvasRenderingContext2D</code></a>
            API take the union type <a href="#dfn-canvasimagesource" class="internalDFN"><code>CanvasImageSource</code></a> as an
            argument. This specification extends the list of <a href="http://www.w3.org/html/wg/drafts/2dcontext/master/#image-sources-for-2d-rendering-contexts">
            image sources for 2D rendering contexts</a> defined in
            [<cite><a class="bibref" href="#bib-2DCONTEXT2">2DCONTEXT2</a></cite>].
          </p>
        </div></div>
        <p>
          A <code>video</code> element whose source is a
          <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code> object containing a <a href="#dfn-depth-track" class="internalDFN">depth
          track</a> is said to be a <dfn id="dfn-depth-video-element">depth video element</dfn>.
        </p>
        <p>
          A <a href="#dfn-depth-video-element" class="internalDFN">depth video element</a> may be used as a
          <a href="#dfn-canvasimagesource" class="internalDFN"><code>CanvasImageSource</code></a>.
        </p>
      </section>
      <section id="imagedata-interface" typeof="bibo:Chapter" resource="#imagedata-interface" property="bibo:hasPart">
        <h3 id="h-imagedata-interface" resource="#h-imagedata-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.6 </span>
          <code>ImageData</code> interface
        </span></h3>
        <div class="note"><div class="note-title" aria-level="4" role="heading" id="h-note2"><span>Note</span></div><div class="">
          <p>
            Depth cameras usually produce 16-bit depth values per pixel.
            However, the canvas drawing surface used to draw and manipulate 2D
            graphics on the web platform does not currently support 16bpp.
          </p>
          <p>
            To address the issue, this specification defines a new data
            representation for current <a href="#dfn-canvas-pixel-arraybuffer" class="internalDFN">Canvas Pixel
            <code>ArrayBuffer</code></a> of <code><a href="#dfn-imagedata" class="internalDFN">ImageData</a></code>
            interface to represent the 16bpp depth image produced by depth
            cameras.
          </p>
        </div></div>
        <p>
          An <code><a href="#dfn-imagedata" class="internalDFN">ImageData</a></code> object is said to <dfn id="dfn-represent-depth-data">represent
          depth data</dfn>, when the <a href="#dfn-canvasimagesource" class="internalDFN"><code>CanvasImageSource</code></a> used
          as the image source for the
          <a href="#dfn-canvasrenderingcontext2d" class="internalDFN"><code>CanvasRenderingContext2D</code></a> is a <a href="#dfn-depth-video-element" class="internalDFN">depth video
          element</a>.
        </p>
        <p>
          When representing a depth image, the <dfn id="dfn-canvas-pixel-arraybuffer">Canvas Pixel
          <code>ArrayBuffer</code></dfn> is an <a href="#dfn-arraybuffer" class="internalDFN"><code>ArrayBuffer</code></a>
          whose data is represented in left-to-right order, row by row top to
          bottom, starting with the top left, with each pixel's lower 8 bit of
          16 bit depth value, upper 8 bit of 16 bit depth value, 8 bit reserved
          data, and another 8 bit reserved data being given in that order for
          each pixel. Each component of each pixel represented in this array
          must be in the range 0..255, representing the 8 bit value for that
          component. The components must be assigned consecutive indices
          starting with 0 for the top left pixel's lower 8 bit of 16 bit depth
          value component.
        </p>
      </section>
      <section id="settings-dictionary" typeof="bibo:Chapter" resource="#settings-dictionary" property="bibo:hasPart">
        <h3 id="h-settings-dictionary" resource="#h-settings-dictionary"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.7 </span>
          <code>Settings</code> dictionary
        </span></h3>
        <p>
          When the <code>getSettings()</code> method is invoked on a
          <a href="#dfn-mediastreamtrack" class="internalDFN"><code>MediaStreamTrack</code></a> object that represents a
          <a href="#dfn-depth-track" class="internalDFN">depth track</a>, the <a href="#dfn-user-agent" class="internalDFN">user agent</a> <em class="rfc2119" title="MUST">MUST</em> return a
          <a href="#idl-def-Settings" class="idlType"><code>Settings</code></a> dictionary with the additional
          properties listed below. When the <code>getSettings()</code> method
          is invoked on a <a href="#dfn-mediastreamtrack" class="internalDFN"><code>MediaStreamTrack</code></a> object that
          represents a <a href="#dfn-video-track" class="internalDFN">video track</a>, the <a href="#dfn-user-agent" class="internalDFN">user agent</a> <em class="rfc2119" title="MAY">MAY</em> return a
          <code>Settings</code> dictionary with the additional properties
          listed below:
        </p>
        <pre class="idl"><span class="idlDictionary" id="idl-def-Settings">partial dictionary <span class="idlDictionaryID">Settings</span> {
<span class="idlMember">    <span class="idlMemberType">double</span> <span class="idlMemberName"><a href="#widl-Settings-focalLength">focalLength</a></span> = <span class="idlMemberValue">null</span>;</span>
<span class="idlMember">    <span class="idlMemberType">double</span> <span class="idlMemberName"><a href="#widl-Settings-horizontalFieldOfView">horizontalFieldOfView</a></span> = <span class="idlMemberValue">null</span>;</span>
<span class="idlMember">    <span class="idlMemberType">double</span> <span class="idlMemberName"><a href="#widl-Settings-verticalFieldOfView">verticalFieldOfView</a></span> = <span class="idlMemberValue">null</span>;</span>
};</span></pre>
        <p>
          The <code id="widl-Settings-focalLength">focalLength</code> attribute
          <em class="rfc2119" title="MUST">MUST</em> return the value it was initialized to. When the object is
          created, this attribute <em class="rfc2119" title="MUST">MUST</em> be initialized to null. It represents
          the focal length of the camera in millimeters.
        </p>
        <p>
          The <code id="widl-Settings-horizontalFieldOfView">horizontalFieldOfView</code>
          attribute <em class="rfc2119" title="MUST">MUST</em> return the value it was initialized to. When the
          object is created, this attribute <em class="rfc2119" title="MUST">MUST</em> be initialized to null. It
          represents the horizontal angle of view in degrees.
        </p>
        <p>
          The <code id="widl-Settings-verticalFieldOfView">verticalFieldOfView</code>
          attribute <em class="rfc2119" title="MUST">MUST</em> return the value it was initialized to. When the
          object is created, this attribute <em class="rfc2119" title="MUST">MUST</em> be initialized to null. It
          represents the vertical angle of view in degrees.
        </p>
      </section>
      <section id="webglrenderingcontext-interface" typeof="bibo:Chapter" resource="#webglrenderingcontext-interface" property="bibo:hasPart">
        <h3 id="h-webglrenderingcontext-interface" resource="#h-webglrenderingcontext-interface"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.8 </span>
          <code>WebGLRenderingContext</code> interface
        </span></h3>
        <section class="informative" id="implementation-considerations-1" typeof="bibo:Chapter" resource="#implementation-considerations-1" property="bibo:hasPart">
          <h4 id="h-implementation-considerations-1" resource="#h-implementation-considerations-1"><span property="xhv:role" resource="xhv:heading"><span class="secno">5.8.1 </span>
            Implementation considerations
          </span></h4><p><em>This section is non-normative.</em></p>
          <p>
            A <code>video</code> element whose source is a
            <code><a href="#idl-def-MediaStream" class="idlType"><code>MediaStream</code></a></code> object containing a <a href="#dfn-depth-track" class="internalDFN">depth
            track</a> may be uploaded to a WebGL texture of format
            <code>RGB</code> and type <code>UNSIGNED_BYTE</code>. [<cite><a class="bibref" href="#bib-WEBGL">WEBGL</a></cite>]
          </p>
          <p>
            For each pixel of this WebGL texture, the R component represents
            the lower 8 bit value of 16 bit depth value, the G component
            represents the upper 8 bit value of 16 bit depth value and the
            value in B component is not defined.
          </p>
        </section>
      </section>
    </section>
    <section class="informative" id="examples" typeof="bibo:Chapter" resource="#examples" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-examples" resource="#h-examples"><span property="xhv:role" resource="xhv:heading"><span class="secno">6. </span>
        Examples
      </span></h2><p><em>This section is non-normative.</em></p>
      <h2 id="x2d-canvas-context-based-post-processing">
        2D Canvas Context based post-processing
      </h2>
      <div class="example"><div class="example-title"><span>Example 1</span></div><pre class="example highlight prettyprint prettyprinted" style=""><span class="kwd">var</span><span class="pln"> canvasContext </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">"canvas"</span><span class="pun">).</span><span class="pln">getContext</span><span class="pun">(</span><span class="str">"2d"</span><span class="pun">);</span><span class="pln">
</span><span class="kwd">var</span><span class="pln"> fps </span><span class="pun">=</span><span class="pln"> </span><span class="lit">60</span><span class="pun">;</span><span class="pln">

navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="pln">
  video</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">
  depth</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">
</span><span class="pun">}).</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// wire the stream into a &lt;video&gt; element for playback</span><span class="pln">
  </span><span class="kwd">var</span><span class="pln"> video </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">querySelector</span><span class="pun">(</span><span class="str">'#video'</span><span class="pun">);</span><span class="pln">
  video</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> stream</span><span class="pun">;</span><span class="pln">
  video</span><span class="pun">.</span><span class="pln">play</span><span class="pun">();</span><span class="pln">
  </span><span class="com">// wire the depth stream into another &lt;video&gt; element to convert kind</span><span class="pln">
  </span><span class="com">// NOTE: Only the R and G bytes are set to carry 16 bits of data</span><span class="pln">
  </span><span class="kwd">var</span><span class="pln"> depthVideo </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">querySelector</span><span class="pun">(</span><span class="str">'#depthVideo'</span><span class="pun">);</span><span class="pln">
  </span><span class="com">// construct a new MediaStream out of the existing depth track(stream)</span><span class="pln">
  </span><span class="kwd">var</span><span class="pln"> depthStream </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">MediaStream</span><span class="pun">(</span><span class="pln">stream</span><span class="pun">.</span><span class="pln">getDepthTracks</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">]);</span><span class="pln">
  depthVideo</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> depthStream</span><span class="pun">;</span><span class="pln">
  depthVideo</span><span class="pun">.</span><span class="pln">play</span><span class="pun">();</span><span class="pln">

  depthVideo</span><span class="pun">.</span><span class="pln">onloadedmetadata </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    setInterval</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
      canvasContext</span><span class="pun">.</span><span class="pln">drawImage</span><span class="pun">(</span><span class="pln">video</span><span class="pun">);</span><span class="pln">
      </span><span class="kwd">var</span><span class="pln"> rgbImageData </span><span class="pun">=</span><span class="pln"> canvasContext</span><span class="pun">.</span><span class="pln">getImageData</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> w</span><span class="pun">,</span><span class="pln"> h</span><span class="pun">);</span><span class="pln">
      </span><span class="kwd">var</span><span class="pln"> pixels </span><span class="pun">=</span><span class="pln"> rgbImageData</span><span class="pun">.</span><span class="pln">data</span><span class="pun">;</span><span class="pln">
      depthCanvasContext</span><span class="pun">.</span><span class="pln">drawImage</span><span class="pun">(</span><span class="pln">depthVideo</span><span class="pun">);</span><span class="pln">
      </span><span class="kwd">var</span><span class="pln"> depthImageData </span><span class="pun">=</span><span class="pln"> depthCanvasContext</span><span class="pun">.</span><span class="pln">getImageData</span><span class="pun">(</span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> w</span><span class="pun">,</span><span class="pln"> h</span><span class="pun">);</span><span class="pln">
      </span><span class="kwd">var</span><span class="pln"> dexels </span><span class="pun">=</span><span class="pln"> depthImageData</span><span class="pun">.</span><span class="pln">data</span><span class="pun">;</span><span class="pln">

      </span><span class="com">// iterate through depth pixels to convert 2 bytes into 1 Uint16</span><span class="pln">
      </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> x </span><span class="pun">&lt;</span><span class="pln"> w </span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
        </span><span class="kwd">for</span><span class="pln"> </span><span class="pun">(</span><span class="kwd">var</span><span class="pln"> y </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"> y </span><span class="pun">&lt;</span><span class="pln"> h</span><span class="pun">;</span><span class="pln"> </span><span class="pun">++</span><span class="pln">y</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
          </span><span class="kwd">var</span><span class="pln"> i </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> y </span><span class="pun">*</span><span class="pln"> w</span><span class="pun">)</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> </span><span class="lit">4</span><span class="pun">;</span><span class="pln">
          </span><span class="com">// combine the R &amp; G pixels at (x, y) to get</span><span class="pln">
          </span><span class="com">// the 16 bit depth pixel value</span><span class="pln">
          </span><span class="kwd">var</span><span class="pln"> depth </span><span class="pun">=</span><span class="pln"> dexels</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">|</span><span class="pln"> dexels</span><span class="pun">[</span><span class="pln">i </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln"> </span><span class="pun">&lt;&lt;</span><span class="pln"> </span><span class="lit">8</span><span class="pun">;</span><span class="pln">
        </span><span class="pun">}</span><span class="pln">
      </span><span class="pun">}</span><span class="pln">
      </span><span class="com">// do things with pixels and dexels here</span><span class="pln">
    </span><span class="pun">},</span><span class="pln"> </span><span class="lit">1000</span><span class="pun">/</span><span class="pln">fps</span><span class="pun">);</span><span class="pln">
  </span><span class="pun">};</span><span class="pln">
</span><span class="pun">}).</span><span class="kwd">catch</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">reason</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// handle gUM error here</span><span class="pln">
</span><span class="pun">});</span></pre></div>
      <h2 id="webgl-fragment-shader-based-post-processing">
        WebGL Fragment Shader based post-processing
      </h2>
      <div class="example"><div class="example-title"><span>Example 2</span></div><pre class="example highlight prettyprint prettyprinted" style=""><span class="com">// This code sets up a video element from a depth stream, uploads it to a WebGL</span><span class="pln">
</span><span class="com">// texture, and samples that texture in the fragment shader, reconstructing the</span><span class="pln">
</span><span class="com">// 16-bit depth values from the red and green channels.</span><span class="pln">
navigator</span><span class="pun">.</span><span class="pln">mediaDevices</span><span class="pun">.</span><span class="pln">getUserMedia</span><span class="pun">({</span><span class="pln">
  depth</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">true</span><span class="pun">,</span><span class="pln">
</span><span class="pun">}).</span><span class="kwd">then</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">stream</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// wire the stream into a &lt;video&gt; element for playback</span><span class="pln">
  </span><span class="kwd">var</span><span class="pln"> depthVideo </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">querySelector</span><span class="pun">(</span><span class="str">'#depthVideo'</span><span class="pun">);</span><span class="pln">
  depthVideo</span><span class="pun">.</span><span class="pln">srcObject </span><span class="pun">=</span><span class="pln"> stream</span><span class="pun">;</span><span class="pln">
  depthVideo</span><span class="pun">.</span><span class="pln">play</span><span class="pun">();</span><span class="pln">
</span><span class="pun">}).</span><span class="kwd">catch</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">reason</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
  </span><span class="com">// handle gUM error here</span><span class="pln">
</span><span class="pun">});</span><span class="pln">

</span><span class="com">// ... later, in the rendering loop ...</span><span class="pln">
gl</span><span class="pun">.</span><span class="pln">texImage2D</span><span class="pun">(</span><span class="pln">
   gl</span><span class="pun">.</span><span class="pln">TEXTURE_2D</span><span class="pun">,</span><span class="pln">
   </span><span class="lit">0</span><span class="pun">,</span><span class="pln">
   gl</span><span class="pun">.</span><span class="pln">RGB</span><span class="pun">,</span><span class="pln">
   gl</span><span class="pun">.</span><span class="pln">RGB</span><span class="pun">,</span><span class="pln">
   gl</span><span class="pun">.</span><span class="pln">UNSIGNED_BYTE</span><span class="pun">,</span><span class="pln">
   depthVideo
</span><span class="pun">);</span><span class="pln">

</span><span class="pun">&lt;</span><span class="pln">script id</span><span class="pun">=</span><span class="str">"fragment-shader"</span><span class="pln"> type</span><span class="pun">=</span><span class="str">"x-shader/x-fragment"</span><span class="pun">&gt;</span><span class="pln">
  varying vec2 v_texCoord</span><span class="pun">;</span><span class="pln">
  </span><span class="com">// u_tex points to the texture unit containing the depth texture.</span><span class="pln">
  uniform sampler2D u_tex</span><span class="pun">;</span><span class="pln">
  </span><span class="kwd">void</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln">
    vec4 floatColor </span><span class="pun">=</span><span class="pln"> texture2D</span><span class="pun">(</span><span class="pln">u_tex</span><span class="pun">,</span><span class="pln"> v_texCoord</span><span class="pun">);</span><span class="pln">
    vec3 rgb </span><span class="pun">=</span><span class="pln"> floatColor</span><span class="pun">.</span><span class="pln">rgb</span><span class="pun">;</span><span class="pln">
    </span><span class="com">// ...</span><span class="pln">
    </span><span class="kwd">float</span><span class="pln"> depth </span><span class="pun">=</span><span class="pln"> rgb</span><span class="pun">.</span><span class="pln">r </span><span class="pun">+</span><span class="pln"> </span><span class="lit">256.</span><span class="pln"> </span><span class="pun">*</span><span class="pln"> rgb</span><span class="pun">.</span><span class="pln">g</span><span class="pun">;</span><span class="pln">
    </span><span class="com">// ...</span><span class="pln">
  </span><span class="pun">}</span><span class="pln">
</span><span class="pun">&lt;/</span><span class="pln">script</span><span class="pun">&gt;</span></pre></div>
    </section>
    <section class="appendix" id="acknowledgements" typeof="bibo:Chapter" resource="#acknowledgements" property="bibo:hasPart">
      <!--OddPage--><h2 id="h-acknowledgements" resource="#h-acknowledgements"><span property="xhv:role" resource="xhv:heading"><span class="secno">A. </span>
        Acknowledgements
      </span></h2>
      <p>
        Thanks to everyone who contributed to the <a href="https://www.w3.org/wiki/Media_Capture_Depth_Stream_Extension">Use
        Cases and Requirements</a>, sent feedback and comments. Special thanks
        to Ningxin Hu for experimental implementations, as well as to the
        Project Tango for their experiments.
      </p>
    </section>
  

<section id="references" class="appendix" typeof="bibo:Chapter" resource="#references" property="bibo:hasPart"><!--OddPage--><h2 id="h-references" resource="#h-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">B. </span>References</span></h2><section id="normative-references" typeof="bibo:Chapter" resource="#normative-references" property="bibo:hasPart"><h3 id="h-normative-references" resource="#h-normative-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">B.1 </span>Normative references</span></h3><dl class="bibliography" resource=""><dt id="bib-2DCONTEXT2">[2DCONTEXT2]</dt><dd>Rik Cabanier; Jatinder Mann; Jay Munro; Tom Wiltzius; Ian Hickson. <a href="http://www.w3.org/TR/2dcontext2/" property="dc:requires"><cite>HTML Canvas 2D Context, Level 2</cite></a>. 28 August 2014. W3C Working Draft. URL: <a href="http://www.w3.org/TR/2dcontext2/" property="dc:requires">http://www.w3.org/TR/2dcontext2/</a>
</dd><dt id="bib-GETUSERMEDIA">[GETUSERMEDIA]</dt><dd>Daniel Burnett; Adam Bergkvist; Cullen Jennings; Anant Narayanan. <a href="http://www.w3.org/TR/mediacapture-streams/" property="dc:requires"><cite>Media Capture and Streams</cite></a>. 3 September 2013. W3C Working Draft. URL: <a href="http://www.w3.org/TR/mediacapture-streams/" property="dc:requires">http://www.w3.org/TR/mediacapture-streams/</a>
</dd><dt id="bib-RFC2119">[RFC2119]</dt><dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119" property="dc:requires"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119" property="dc:requires">https://tools.ietf.org/html/rfc2119</a>
</dd><dt id="bib-TYPEDARRAY">[TYPEDARRAY]</dt><dd>David Herman; Kenneth Russell. <a href="https://www.khronos.org/registry/typedarray/specs/latest/" property="dc:requires"><cite>Typed Array Specification</cite></a>. 26 June 2013. Khronos Working Draft. URL: <a href="https://www.khronos.org/registry/typedarray/specs/latest/" property="dc:requires">https://www.khronos.org/registry/typedarray/specs/latest/</a>
</dd><dt id="bib-WEBIDL">[WEBIDL]</dt><dd>Cameron McCormack. <a href="http://www.w3.org/TR/WebIDL/" property="dc:requires"><cite>Web IDL</cite></a>. 19 April 2012. W3C Candidate Recommendation. URL: <a href="http://www.w3.org/TR/WebIDL/" property="dc:requires">http://www.w3.org/TR/WebIDL/</a>
</dd></dl></section><section id="informative-references" typeof="bibo:Chapter" resource="#informative-references" property="bibo:hasPart"><h3 id="h-informative-references" resource="#h-informative-references"><span property="xhv:role" resource="xhv:heading"><span class="secno">B.2 </span>Informative references</span></h3><dl class="bibliography" resource=""><dt id="bib-HTML5">[HTML5]</dt><dd>Ian Hickson; Robin Berjon; Steve Faulkner; Travis Leithead; Erika Doyle Navara; Edward O'Connor; Silvia Pfeiffer. <a href="http://www.w3.org/TR/html5/" property="dc:references"><cite>HTML5</cite></a>. 28 October 2014. W3C Recommendation. URL: <a href="http://www.w3.org/TR/html5/" property="dc:references">http://www.w3.org/TR/html5/</a>
</dd><dt id="bib-WEBGL">[WEBGL]</dt><dd>Chris Marrin (Apple Inc.). <a href="https://www.khronos.org/registry/webgl/specs/1.0/" property="dc:references"><cite>WebGL Specification, Version 1.0</cite></a>. 10 February 2011. URL: <a href="https://www.khronos.org/registry/webgl/specs/1.0/" property="dc:references">https://www.khronos.org/registry/webgl/specs/1.0/</a>
</dd></dl></section></section></body></html>